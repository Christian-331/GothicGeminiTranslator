<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="800"
        x:Class="GothicTranslator.MainWindow"
        Title="Gothic Gemini Translator"
        Width="800" Height="800"
        WindowStartupLocation="CenterScreen"
        Icon="/Assets/48x48.ico"
        Closing="MainWinow_Closing">

    <Grid Margin="15" RowDefinitions="Auto,Auto,Auto,Auto,Auto,*,Auto">
        <StackPanel Grid.Row="0" Spacing="5" Margin="0,0,0,15">
            <TextBlock Text="Google Gemini API key:"/>
            <TextBox Name="TxtApiKey" Text=""
                     ToolTip.Tip="You must acquire an API key from Google."/>
        </StackPanel>
        
        <Grid Grid.Row="1" ColumnDefinitions="*, Auto" Margin="0,0,0,15">
            <TextBox Name="TxtFilePath" Grid.Column="0" IsReadOnly="True" Watermark="No file selected..."/>
            <Button Name="BtnBrowse" Content="Browse CSV..." Grid.Column="1" Margin="10,0,0,0" Click="BtnBrowse_Click"
                    ToolTip.Tip="Choose the EGMT CSV file."/>
        </Grid>
        
        <Grid Grid.Row="2" ColumnDefinitions="*, Auto, Auto" Margin="0,0,0,15">
            <TextBox Name="TxtDictionaryPath" Grid.Column="0" IsReadOnly="True" Watermark="No file selected..."/>
            <Button Name="BtnBrowseDictionary" Content="Browse dictionary..." Grid.Column="1" Margin="10,0,0,0"
                    Click="BtnBrowseDictionary_Click"
                    ToolTip.Tip="Choose a dictionary file (optional). The full text of the file will be given to the AI as a reference dictionary."/>
            <Button Name="BtnClearDictionary" Content="Remove" Grid.Column="2" Margin="10,0,0,0"
                    Click="BtnClearDictionary_Click"/>
        </Grid>
        
        <Grid Grid.Row="3" Margin="0,0,0,15" RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="Auto,Auto,Auto,Auto">
            <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,0,5,5" Text="Source language:" VerticalAlignment="Center"/>
            <ComboBox Grid.Row="0" Grid.Column="1" Margin="0,0,5,5" Name="ComboSourceLanguage" Width="200" SelectedIndex="3"
                      VerticalAlignment="Center" HorizontalAlignment="Center"
                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                      IsEditable="True" SelectionChanged="ComboSourceLanguage_OnSelectionChanged">
                <ComboBoxItem Content="English"/>
                <ComboBoxItem Content="German"/>
                <ComboBoxItem Content="Russian"/>
                <ComboBoxItem Content="Polish"/>
                <ComboBoxItem Content="Czech"/>
                <ComboBoxItem Content="Romanian"/>
            </ComboBox>
            <TextBlock Grid.Row="0" Grid.Column="2" Margin="0,0,5,5" Text="Header:" VerticalAlignment="Center"/>
            <ComboBox Grid.Row="0" Grid.Column="3" Margin="0,0,5,5" Name="ComboSourceHeader" Width="200" SelectedIndex="3"
                      VerticalAlignment="Center" HorizontalAlignment="Center"
                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                      IsEditable="True" SelectionChanged="ComboSourceHeader_OnSelectionChanged">
                <ComboBoxItem Content="EN"/>
                <ComboBoxItem Content="DE"/>
                <ComboBoxItem Content="RU"/>
                <ComboBoxItem Content="PL"/>
                <ComboBoxItem Content="CS"/>
                <ComboBoxItem Content="RO"/>
            </ComboBox>
            <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,0,5,5" Text="Target language:" VerticalAlignment="Center"/>
            <ComboBox Grid.Row="1" Grid.Column="1" Margin="0,0,5,5" Name="ComboTargetLanguage" Width="200" SelectedIndex="0"
                      VerticalAlignment="Center" HorizontalAlignment="Center"
                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                      IsEditable="True" SelectionChanged="ComboTargetLanguage_OnSelectionChanged">
                <ComboBoxItem Content="English"/>
                <ComboBoxItem Content="German"/>
                <ComboBoxItem Content="Russian"/>
                <ComboBoxItem Content="Polish"/>
                <ComboBoxItem Content="Czech"/>
                <ComboBoxItem Content="Romanian"/>
            </ComboBox>
            <TextBlock Grid.Row="1" Grid.Column="2" Margin="0,0,5,5" Text="Target header:" VerticalAlignment="Center"/>
            <ComboBox Grid.Row="1" Grid.Column="3" Margin="0,0,5,5" Name="ComboTargetHeader" Width="200" SelectedIndex="0"
                      VerticalAlignment="Center" HorizontalAlignment="Center"
                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                      IsEditable="True" SelectionChanged="ComboTargetHeader_OnSelectionChanged">
                <ComboBoxItem Content="EN"/>
                <ComboBoxItem Content="DE"/>
                <ComboBoxItem Content="RU"/>
                <ComboBoxItem Content="PL"/>
                <ComboBoxItem Content="CS"/>
                <ComboBoxItem Content="RO"/>
            </ComboBox>
            <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,0,5,5" Text="Output tokens:" VerticalAlignment="Center"/>
            <TextBox Grid.Row="2" Grid.Column="1" Margin="0,0,5,5" Name="TxtOutputTokens" Text="65536" Width="200" TextAlignment="Center"
                     ToolTip.Tip="The total maximum output tokens including thinking tokens"/>
            <TextBlock Grid.Row="2" Grid.Column="2" Margin="0,0,5,5" Text="Token factor:" VerticalAlignment="Center"/>
            <TextBox Grid.Row="2" Grid.Column="3" Margin="0,0,5,5" Name="TxtTokenFactor" Text="0.25" Width="200" TextAlignment="Center"
                     ToolTip.Tip="This factor is used for estimating the number of output tokens based on the length of the input. Raise if you get MAX_TOKENS errors. Lower to get closer to maximum output tokens. (Default value: 0.25)"/>
            <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,0,5,5" Text="Thinking tokens:" VerticalAlignment="Center"/>
            <TextBox Grid.Row="3" Grid.Column="1" Margin="0,0,5,5" Name="TxtThinkingTokens" Text="24576" Width="200" TextAlignment="Center"
                     ToolTip.Tip="How many tokens the AI can use to think. Must be smaller than output tokens."/>
            <TextBlock Grid.Row="3" Grid.Column="2" Margin="0,0,5,5" Text="Model:" VerticalAlignment="Center"/>
            <ComboBox Grid.Row="3" Grid.Column="3" Margin="0,0,5,5" Name="ComboModel" Width="200" SelectedIndex="0"
                      VerticalAlignment="Center" HorizontalAlignment="Center"
                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                      IsEditable="True">
                <ComboBoxItem Content="gemini-3-flash-preview"/>
                <ComboBoxItem Content="gemini-3-pro-preview"/>
                <ComboBoxItem Content="gemini-2.5-flash"/>
                <ComboBoxItem Content="gemini-2.5-flash-lite"/>
                <ComboBoxItem Content="gemini-2.5-pro"/>
                <ComboBoxItem Content="gemini-2.0-flash"/>
                <ComboBoxItem Content="gemini-2.0-flash-lite"/>
            </ComboBox>
        </Grid>
        
        <Grid Grid.Row="4" Margin="0,0,0,15">
            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Left">
                <Button Name="BtnStart" Content="Start translation" 
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                        VerticalAlignment="Stretch" VerticalContentAlignment="Center"
                        Height="40" FontSize="16" FontWeight="Bold"
                        Click="BtnStart_Click" Margin="0,0,0,15"/>
        
                <Button Name="BtnStop" Content="Stop" 
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                        VerticalAlignment="Stretch" VerticalContentAlignment="Center"
                        Height="40" FontSize="16" FontWeight="Bold"
                        Click="BtnSop_Click" Margin="0,0,0,15"
                        ToolTip.Tip="Stop the translation process after this iteration and save the current progress."/>
        
                <Button Name="BtnAbort" Content="Abort" 
                        HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                        VerticalAlignment="Stretch" VerticalContentAlignment="Center"
                        Height="40" FontSize="16" FontWeight="Bold"
                        Click="BtnAbort_Click" Margin="0,0,0,15"
                        ToolTip.Tip="Abort the translation process immediately and discard all progress."/>
            </StackPanel>
            
            <CheckBox Name="CheckBoxDebug" Content="Show extended messages"
                      HorizontalAlignment="Right" 
                      VerticalAlignment="Center"
                      VerticalContentAlignment="Center"
                      FontSize="16"
                      Margin="0,0,0,15"
                      IsCheckedChanged="CheckBoxDebug_OnIsCheckedChanged"/>
        </Grid>
        
        <TextBox Name="TxtLog" Grid.Row="5" 
                 IsReadOnly="True" 
                 FontFamily="Consolas, Monospace" 
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 Margin="0,0,0,10"/>
        
        <Grid Grid.Row="6">
            <ProgressBar Name="StatusProgressBar" Height="20" Minimum="0" Maximum="100"/>
        </Grid>
    </Grid>
</Window>
